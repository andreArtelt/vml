function vml_PolynomialRegression(){this.lWeights=null;this.lData=[];this.lLabels=[];this.BigPhi=null;this.iDegree=0;this.Init=function(b,a){this.iDegree=b;this.ConvertData(a);this.lWeights=math.random([this.iDegree+1],-5,5)};this.ComputePhi=function(a){return vml_utils.ComputePolynomPhi(a,this.iDegree)};this.ConvertData=function(b){this.lData=[];this.lLabels=[];this.BigPhi=[];for(var c=0;c!=b.length;c++){var a=b[c];var d=this.ComputePhi(a[0]);this.BigPhi.push(d);this.lData.push(math.matrix(d));this.lLabels.push(a[1])}this.BigPhi=math.matrix(this.BigPhi)};this.ComputeRSS=function(){var a=0;var e=math.transpose(this.lWeights);for(var d=0;d!=this.lData.length;d++){var b=this.lData[d];var c=this.lLabels[d];a+=Math.pow(c-math.multiply(e,b),2)}return a};this.Fit=function(e){var b=math.transpose(this.BigPhi);var g=this.iDegree+1;var a=math.eye(g,g);var h=math.matrix(this.lLabels);var c=e;var f=vml_math.MultiplyScalar(a,c);this.lWeights=math.multiply(math.multiply(math.inv(math.add(f,math.multiply(b,this.BigPhi))),b),h);if(g==1){this.lWeights=math.matrix([this.lWeights])}};this.UpdateWeights=function(c,g){var a=undefined;var f=math.transpose(this.lWeights);var d=vml_math.MultiplyScalar(math.abs(this.lWeights),g);for(var e=0;e!=this.lData.length;e++){var j=this.lData[e];var h=this.lLabels[e];var k=vml_math.MultiplyScalar(j,h-math.multiply(f,j));if(a==undefined){a=k}else{a=math.add(a,k)}}a=vml_math.MultiplyScalar(a,-1/this.lData.length);var b=math.add(a,d);this.lWeights=math.subtract(this.lWeights,vml_math.MultiplyScalar(b,c))};this.Predict=function(a){return math.multiply(math.transpose(this.lWeights),math.matrix(this.ComputePhi(a)))}};